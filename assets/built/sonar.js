function buildChecks(){var e,t=document.querySelectorAll("[data-slug]"),o=document.getElementById("toc-list"),r=[location.pathname];let n;null!=(e=JSON.parse(localStorage.getItem("ugPrefs")))?r in e&&(n=e[r]):n={};for(tag of t){var i=document.createElement("li"),a=(i.className="toc-list-item",document.createElement("input")),s=(a.type="checkbox",a.value=tag.id,a.name=tag.textContent.trim(),a.addEventListener("click",checkBoxHandler.bind(null,a.value)),document.createElement("label"));s.htmlFor=a.value,s.textContent=tag.textContent.trim(),a.classList="mr-4 form-check text-primary-900 dark:text-accent-400 rounded",s.classList="text-primary-900 dark:text-accent-400 font-medium",o.appendChild(i),i.appendChild(a),i.appendChild(s),null!=n&&a.value in n&&(a.checked=!0)}firstRender()}function checkBoxHandler(e,t){var o=getBoxes("CHECKED"),r=getBoxes("UNCHECKED"),n=getBoxes("CATEGORIES");if(0==o.length)n.forEach(e=>e.classList.remove("hidden"));else if(1==o.length)for(category of n)for(uncheck of r)category.dataset.visibility==uncheck.value&&category.classList.add("hidden");else document.querySelector(`[data-visibility=${CSS.escape(e)}]`).classList.toggle("hidden");setPreferences()}function firstRender(){var e=getBoxes("CHECKED");if(0<e.length)for(uncheck of getBoxes("UNCHECKED"))document.querySelector(`[data-visibility=${CSS.escape(uncheck.value)}]`).classList.toggle("hidden")}function setPreferences(){let e=JSON.parse(localStorage.getItem("ugPrefs"));null===e&&((e={})[location.pathname]={});var t={},o=getBoxes("CHECKED");if(0<o.length)for(check of o)t[""+check.value]=!0;e[location.pathname]=t,localStorage.setItem("ugPrefs",JSON.stringify(e))}function getBoxes(e){switch(e){case"CHECKED":return document.querySelectorAll("input:checked");case"UNCHECKED":return document.querySelectorAll("input:not(:checked)");case"CATEGORIES":return document.querySelectorAll("[data-visibility]");case"BOXES":return document.querySelectorAll('input[type="checkbox"]')}}function getPreferences(){return sanitizePreferences([location.pathname],2e3)}function sanitizePreferences(e,t){if(null===(r=localStorage.getItem("ugPrefs")))return{};if(r.length>t)return{};var o=[];for(categoryDiv of getBoxes("BOXES"))o.push(categoryDiv.value);var r,n={};for(initialPref in JSON.parse(localStorage.getItem("ugPrefs"))[e])o.includes(initialPref)&&(n[""+initialPref]=!0);return n}!function(i){"use strict";i.fn.fitVids=function(e){var t,o,n={customSelector:null,ignore:null};return document.getElementById("fit-vids-style")||(t=document.head||document.getElementsByTagName("head")[0],(o=document.createElement("div")).innerHTML='<p>x</p><style id="fit-vids-style">.fluid-width-video-container{flex-grow: 1;width:100%;}.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style>',t.appendChild(o.childNodes[1])),e&&i.extend(n,e),this.each(function(){var e=['iframe[src*="player.vimeo.com"]','iframe[src*="youtube.com"]','iframe[src*="youtube-nocookie.com"]','iframe[src*="kickstarter.com"][src*="video.html"]',"object","embed"],r=(n.customSelector&&e.push(n.customSelector),".fitvidsignore"),e=(n.ignore&&(r=r+", "+n.ignore),i(this).find(e.join(",")));(e=(e=e.not("object object")).not(r)).each(function(){var e,t,o=i(this);0<o.parents(r).length||"embed"===this.tagName.toLowerCase()&&o.parent("object").length||o.parent(".fluid-width-video-wrapper").length||(o.css("height")||o.css("width")||!isNaN(o.attr("height"))&&!isNaN(o.attr("width"))||(o.attr("height",9),o.attr("width",16)),e=("object"===this.tagName.toLowerCase()||o.attr("height")&&!isNaN(parseInt(o.attr("height"),10))?parseInt(o.attr("height"),10):o.height())/(isNaN(parseInt(o.attr("width"),10))?o.width():parseInt(o.attr("width"),10)),o.attr("name")||(t="fitvid"+i.fn.fitVids._count,o.attr("name",t),i.fn.fitVids._count++),o.wrap('<div class="fluid-width-video-container"><div class="fluid-width-video-wrapper"></div></div>').parent(".fluid-width-video-wrapper").css("padding-top",100*e+"%"),o.removeAttr("height").removeAttr("width"))})})},i.fn.fitVids._count=0}(window.jQuery||window.Zepto),$(".postItem:empty").parent().remove(),buildChecks();var firebaseConfig={apiKey:"AIzaSyCM0FHbolc3QT-PfoLixcoeVS3JoWhheEg",authDomain:"ultrasound-guidance.firebaseapp.com",projectId:"ultrasound-guidance",storageBucket:"ultrasound-guidance.appspot.com",messagingSenderId:"947728965057",appId:"1:947728965057:web:32b2bb26469a78c9762340"};firebase.initializeApp(firebaseConfig);const firebaseDB=firebase.firestore();var modal=document.getElementById("myModal"),formContainer=document.querySelector(".form"),submit=document.querySelector(".submit-form"),closeBtn=document.getElementById("closeBtn"),postData=document.querySelector("#post"),iframes=document.querySelectorAll("iframe"),formName="Default";function getForm(){firebaseDB.collection("forms").doc("Default").get().then(e=>{e.exists&&e.data().items.slice().reverse().forEach(e=>{e=`
            <label>${e.title}</label><br>
            <input type="text" style="width: 100%;" id="${e.itemId}" ></br>
            `;formContainer.insertAdjacentHTML("afterbegin",e)})}).catch(e=>{console.log("Error getting document:",e)})}closeBtn&&closeBtn.addEventListener("click",()=>{modal.style.display="none"}),window.onclick=function(e){e.target==modal&&(modal.style.display="none")},submit&&(submit.onclick=function(e){e.preventDefault();var e=document.querySelectorAll("input"),t={};e.forEach(e=>{t[e.id]={questionId:e.id,textAnswers:{answers:[{value:e.value}]}}}),player.getVideoId().then(e=>{firebaseDB.collection("formResponses").doc(formName).set({responses:{[postData.dataset.memberEmail]:firebase.firestore.FieldValue.arrayUnion({responseId:crypto.randomUUID(),videoId:e,createTime:(new Date).toISOString(),answers:t})}},{merge:!0}).then(()=>{modal.style.display="none"}).catch(e=>{console.error("Error submitting form: ",e)})})}),postData&&iframes&&iframes.forEach(e=>{var r=new Vimeo.Player(e);r.getVideoId().then(t=>{firebaseDB.collection("users").doc(postData.dataset.memberEmail).get().then(e=>{e.exists?(e=e.data().watchedVideosProgress[postData.dataset.postId][t].watchedSeconds,r.setCurrentTime(e).then(()=>{}).catch(e=>{e.name})):console.log("Unable to get Video watched seconds: No such document")}).catch(e=>{console.log("No document found:",e)})}),r.on("play",()=>{r.getVideoId().then(e=>{var t=document.querySelectorAll(".kg-embed-card").length;firebaseDB.collection("users").doc(postData.dataset.memberEmail).set({watchedVideosProgress:{[postData.dataset.postId]:{[e]:{postId:postData.dataset.postId,videoId:e},videoCount:t}}},{merge:!0}).catch(e=>{console.error("Error adding document: ",e)})})}),r.on("pause",()=>{r.getCurrentTime().then(o=>{r.getDuration().then(t=>{r.getVideoId().then(e=>{firebaseDB.collection("users").doc(postData.dataset.memberEmail).set({watchedVideosProgress:{[postData.dataset.postId]:{[e]:{watchedSeconds:o-5,progressPosition:o/t}}}},{merge:!0}).catch(e=>{console.error("Error updating document: ",e)})})})})}),r.on("ended",()=>{r.getCurrentTime().then(e=>{firebaseDB.collection("users").doc(postData.dataset.memberEmail).set({watchedVideos:{[postData.dataset.postId]:{watchedSeconds:60,progressPosition:1}}},{merge:!0}).then(()=>{r.off("pause")}).catch(e=>{console.error("Error updating document on end event: ",e)})})})}),function(e){e.addEventListener("DOMContentLoaded",function(){e.querySelectorAll(".kg-gallery-image img").forEach(function(e){var t=e.closest(".kg-gallery-image"),o=e.attributes.width.value,e=e.attributes.height.value;t.style.flex=o/e+" 1 0%"})})}((window,document)),function(t,o){var r,n,i,a,s,c,d,l=o.querySelector("link[rel=next]");function u(){var e;404===this.status?(t.removeEventListener("scroll",h),t.removeEventListener("resize",f)):(this.response.querySelectorAll("article.post-card").forEach(function(e){r.appendChild(o.importNode(e,!0))}),(e=this.response.querySelector("link[rel=next]"))?l.href=e.href:(t.removeEventListener("scroll",h),t.removeEventListener("resize",f)),d=o.documentElement.scrollHeight,a=i=!1)}function e(){var e;a||(s+c<=d-n?i=!1:(a=!0,(e=new t.XMLHttpRequest).responseType="document",e.addEventListener("load",u),e.open("GET",l.href),e.send(null)))}function m(){i||t.requestAnimationFrame(e),i=!0}function h(){s=t.scrollY,m()}function f(){c=t.innerHeight,d=o.documentElement.scrollHeight,m()}l&&(r=o.querySelector(".post-feed"))&&(a=i=!(n=300),s=t.scrollY,c=t.innerHeight,d=o.documentElement.scrollHeight,t.addEventListener("scroll",h,{passive:!0}),t.addEventListener("resize",f),m())}(window,document),window.addEventListener("DOMContentLoaded",function(){var e=document.querySelector(".postItem");e&&firebaseDB.collection("users").doc(e.dataset.memberEmail).get().then(e=>{if(e.exists){e=e.data().watchedVideosProgress;let r=1;Object.entries(e).forEach(([e,t])=>{t.videoCount&&(r=t.videoCount);let o=0;Object.entries(t).forEach(([,e])=>{e.progressPosition&&(o+=e.progressPosition)}),document.getElementById(e).style.setProperty("--progress-position",o/r)})}else console.log("No such document!")}).catch(e=>{console.log("Error getting document:",e)})});
//# sourceMappingURL=sonar.js.map